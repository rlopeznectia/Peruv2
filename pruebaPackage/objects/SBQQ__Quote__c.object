<?xml version="1.0" encoding="UTF-8"?>
<CustomObject xmlns="http://soap.sforce.com/2006/04/metadata">
    <enableEnhancedLookup>false</enableEnhancedLookup>
    <fields>
        <fullName>Carga_Media__c</fullName>
        <externalId>false</externalId>
        <formula>BV_Mensual__c / N_de_Beneficiarios__c</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>BV Mensual dividido por la Cantidad de Beneficiarios</inlineHelpText>
        <label>Carga Media</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Currency</type>
    </fields>
    <fields>
        <fullName>Dias_de_Credito__c</fullName>
        <externalId>false</externalId>
        <inlineHelpText>Días de credito ofrecidos</inlineHelpText>
        <label>Días de Crédito</label>
        <precision>18</precision>
        <required>false</required>
        <scale>0</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>EditLinesFieldSetName__c</fullName>
        <externalId>false</externalId>
        <label>EditLinesFieldSetName</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Picklist</type>
        <valueSet>
            <restricted>true</restricted>
            <valueSetDefinition>
                <sorted>false</sorted>
                <value>
                    <fullName>Line_Editor_Merchants</fullName>
                    <default>false</default>
                    <label>Line_Editor_Merchants</label>
                </value>
                <value>
                    <fullName>SBQQ__LineEditor</fullName>
                    <default>false</default>
                    <label>SBQQ__LineEditor</label>
                </value>
            </valueSetDefinition>
        </valueSet>
    </fields>
    <fields>
        <fullName>Frecuencia__c</fullName>
        <externalId>false</externalId>
        <formula>SBQQ__Opportunity2__r.Frecuencia_f__c</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Frecuencia</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Gestion__c</fullName>
        <externalId>false</externalId>
        <formula>SBQQ__Account__r.Gestion__c</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Muestra el campo Gestion de la cuenta relacionada para usar como parametro en Tabla de Precios-</inlineHelpText>
        <label>Gestión</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>IGV__c</fullName>
        <externalId>false</externalId>
        <formula>SBQQ__NetAmount__c * 0.18</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>IGV</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Currency</type>
    </fields>
    <fields>
        <fullName>LogoProducto__c</fullName>
        <externalId>false</externalId>
        <formula>CASE(				 SBQQ__Opportunity2__r.SDX_Segmento__c ,

&quot;FOOD&quot;, &quot;&lt;p&gt;&lt;img height=&apos;128&apos; src=&apos;https://sodexo-brs-peru--uat2--c.documentforce.com/servlet/servlet.ImageServer?id=0150m000000Qo0V&amp;amp;oid=00D0m0000001gRs&amp;amp;lastMod=1620963075000&apos; width=&apos;238&apos; /&gt;&lt;/p&gt;&quot;,
&quot;MEAL&quot;, &quot;0T_009EAU052127&quot;,
&quot;EDUCATION&quot;, &quot;&lt;p&gt;&lt;img height=&apos;128&apos; src=&apos;https://sodexo-brs-peru--uat2--c.documentforce.com/servlet/servlet.ImageServer?id=0150m000000Qo0a&amp;oid=00D0m0000001gRs&amp;lastMod=1620963237000&apos; width=&apos;238&apos; /&gt;&lt;/p&gt;&quot;,
&quot;&quot;)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>LogoProducto</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Min_Frecuencia_de_Reembolsos__c</fullName>
        <description>Valor menor de la cotización para el campo Frecuencia de Reembolsos. Necesario para definir si se requiere aprobación.</description>
        <externalId>false</externalId>
        <label>Min Frecuencia de Reembolsos</label>
        <summarizedField>SBQQ__QuoteLine__c.Frecuencia_de_Reembolsos__c</summarizedField>
        <summaryForeignKey>SBQQ__QuoteLine__c.SBQQ__Quote__c</summaryForeignKey>
        <summaryOperation>min</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>N_de_Beneficiarios__c</fullName>
        <externalId>false</externalId>
        <inlineHelpText>Cantidad de beneficiarios</inlineHelpText>
        <label>Nº de Beneficiarios</label>
        <precision>18</precision>
        <required>false</required>
        <scale>0</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Nombre_del_Tipo_de_Registro_de_la_Oppty__c</fullName>
        <description>Utilizado para seleccionar el PricebookID de la Cotización en Process Builder.</description>
        <externalId>false</externalId>
        <formula>SBQQ__Opportunity2__r.RecordType.Name</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Devuelve el nombre del tipo de registro de la Oportunidad. Utilizado para automatizar elección de lista de precio</inlineHelpText>
        <label>Nombre del Tipo de Registro de la Oppty</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Quote_Aprobado__c</fullName>
        <defaultValue>false</defaultValue>
        <externalId>false</externalId>
        <label>Quote Aprobado</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Requiere_Aprobaci_n_Finanzas__c</fullName>
        <externalId>false</externalId>
        <formula>IF(SBQQ__LineItemCount__c &gt; 0, 

    OR(  Dias_de_Credito__c &gt;0 ,  aprobacion_Comision_Min__c &lt;=0), 

    false)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Indica si se requiere Aprobación de FInanzas. Se utiliza como criterio de entrada y validación del proceso de aprobación cliente.</inlineHelpText>
        <label>Requiere Aprobación Finanzas</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Requiere_Aprobacion_Comercial__c</fullName>
        <description>formula anterior: OR(  Carga_Media__c &lt;100 , aprobacion_Premium_Vigencia_Max__c &gt;=11, aprobacion_Vigencia_No_Premium_Max__c &gt;=6)</description>
        <externalId>false</externalId>
        <formula>if( and(SBQQ__LineItemCount__c  &gt; 0 , Tipo_Oportunidad__c = &apos;Cliente&apos; ),


or(
    Carga_Media__c &lt;100,

    and( Vigencia__c &gt;=6,   SBQQ__Opportunity2__r.Frecuencia_f__c  = &apos;NoRecurrente&apos;),

    and(Vigencia__c &gt;=11,  SBQQ__Opportunity2__r.Frecuencia_f__c = &apos;Recurrente&apos;, ISPICKVAL(SBQQ__Opportunity2__r.SDX_Segmento__c, &apos;EXTERNAL ESTIMULATION&apos;)),
   
    aprobacion_Comision_Min__c &lt;=0

) ,
false)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Criterio de entrada para Aprobacion Comercial</inlineHelpText>
        <label>Requiere Aprobación Comercial</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Requiere_Aprobacion_Comision__c</fullName>
        <externalId>false</externalId>
        <formula>IF(SBQQ__LineItemCount__c &gt; 0,
aprobacion_Comision_Min__c &lt;=0,
false)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Requiere Aprobación Comisión</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Requiere_Aprobacion_Dias_Credito__c</fullName>
        <externalId>false</externalId>
        <formula>IF(SBQQ__LineItemCount__c &gt; 0,
			Dias_de_Credito__c &gt;0 ,false)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Requiere Aprobación Días Crédito</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Requiere_Aprobacion_Finanzas_Merchant__c</fullName>
        <externalId>false</externalId>
        <formula>IF( and(SBQQ__LineItemCount__c &gt;0 , Tipo_Oportunidad__c = &apos;Merchant&apos; ),
  Min_Frecuencia_de_Reembolsos__c &lt; 5, 
  false)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Devuelve si existe una linea de cotización con campo Frecuencia de Reembolsos menor a 5. Esto implica que se requiere Aprobación de FInanzas.</inlineHelpText>
        <label>Requiere Aprobación Finanzas (Merchant)</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Requiere_Aprobacion_Manager_Comercial__c</fullName>
        <externalId>false</externalId>
        <formula>IF( SBQQ__LineItemCount__c &gt; 0, 
  aprobacion_Descuento_Manager_Comercial__c &gt;0, 
  false)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Devuelve True si el campo Descuento Manager Comercial es mayor que cero. Esto indica que hay lineas de la cotización que tiene campo Precio Negociado inferior al maximo de descuento permitido sin aprobación de Manager Comercial</inlineHelpText>
        <label>Requiere Aprobación Manager Comercial</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>Requiere_Aprobacion_Marketing_Merchants__c</fullName>
        <description>Devuelve si existen lineas con comisión menor o igual 2, valor necesario para requerir Aprobación de Marketing</description>
        <externalId>false</externalId>
        <formula>IF( and(SBQQ__LineItemCount__c &gt;0,  Tipo_Oportunidad__c =&apos;Merchant&apos;) , 
  aprobacion_Comision_Min__c &lt;= 2, 
  false)</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Devuelve si existen lineas con comisión menor o igual 2, valor necesario para requerir Aprobación de Marketing</inlineHelpText>
        <label>Requiere Aprobación Marketing (Merchant)</label>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Checkbox</type>
    </fields>
    <fields>
        <fullName>SDX_Total_carga__c</fullName>
        <externalId>false</externalId>
        <label>Total carga</label>
        <summarizedField>SBQQ__QuoteLine__c.SDX_BV_mensual__c</summarizedField>
        <summaryForeignKey>SBQQ__QuoteLine__c.SBQQ__Quote__c</summaryForeignKey>
        <summaryOperation>sum</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>Segmento__c</fullName>
        <description>Se utiliza para el Quote Process</description>
        <externalId>false</externalId>
        <formula>text( SBQQ__Opportunity2__r.SDX_Segmento__c )</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <inlineHelpText>Devuelve el Segmento seleccionado en la Oportunidad relacionada a la Quote.</inlineHelpText>
        <label>Segmento</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>TemplateAccountName__c</fullName>
        <externalId>false</externalId>
        <formula>SBQQ__Account__r.Name</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>TemplateAccountName</label>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Tipo_Oportunidad__c</fullName>
        <description>Debe ser un campo de texto que se completa via process Builder. Necesario para Price Rules qu eno puede tomar valores fuera de la Quote o con referencia fuera de la Quote</description>
        <externalId>false</externalId>
        <inlineHelpText>Tipo de Registro de la oportunidad.</inlineHelpText>
        <label>Tipo Oportunidad</label>
        <length>30</length>
        <required>false</required>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Text</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>Total__c</fullName>
        <externalId>false</externalId>
        <formula>SBQQ__NetAmount__c +  IGV__c</formula>
        <formulaTreatBlanksAs>BlankAsZero</formulaTreatBlanksAs>
        <label>Total</label>
        <precision>18</precision>
        <required>false</required>
        <scale>2</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Currency</type>
    </fields>
    <fields>
        <fullName>Vigencia__c</fullName>
        <externalId>false</externalId>
        <inlineHelpText>Vigencia en meses de la tarjeta</inlineHelpText>
        <label>Vigencia</label>
        <precision>18</precision>
        <required>false</required>
        <scale>0</scale>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Number</type>
        <unique>false</unique>
    </fields>
    <fields>
        <fullName>aprobacion_Comision_Min__c</fullName>
        <externalId>false</externalId>
        <inlineHelpText>Indica el menos valor para la Comisión aplicada en la Cotización. Se utiliza para los criterios de entrada del proceso de Aprobación Cliente.</inlineHelpText>
        <label>Comisión Min</label>
        <summarizedField>SBQQ__QuoteLine__c.Precio_Negociado__c</summarizedField>
        <summaryFilterItems>
            <field>SBQQ__QuoteLine__c.ProductCode_Field__c</field>
            <operation>equals</operation>
            <value>CARGO_POR_SERVICIO</value>
        </summaryFilterItems>
        <summaryForeignKey>SBQQ__QuoteLine__c.SBQQ__Quote__c</summaryForeignKey>
        <summaryOperation>min</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <fields>
        <fullName>aprobacion_Descuento_Manager_Comercial__c</fullName>
        <externalId>false</externalId>
        <inlineHelpText>Indica si hay lineas en la Cotización que superan el limite de descuento sin aprobación</inlineHelpText>
        <label>Descuento Manager Comercial</label>
        <summaryFilterItems>
            <field>SBQQ__QuoteLine__c.Requiere_Aprobacion_Manager_Comercial__c</field>
            <operation>equals</operation>
            <value>True</value>
        </summaryFilterItems>
        <summaryForeignKey>SBQQ__QuoteLine__c.SBQQ__Quote__c</summaryForeignKey>
        <summaryOperation>count</summaryOperation>
        <trackHistory>false</trackHistory>
        <trackTrending>false</trackTrending>
        <type>Summary</type>
    </fields>
    <validationRules>
        <fullName>QT001_InterlocutorMandatorio</fullName>
        <active>true</active>
        <errorConditionFormula>ISNEW() &amp;&amp;
ISBLANK(SBQQ__Opportunity2__r.Interlocutor__c)</errorConditionFormula>
        <errorMessage>QT001: Para poder crear la Quote debes primero señalar un Interlocutor en la Oportunidad de origen.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>QT002_NumeroEmpleados</fullName>
        <active>true</active>
        <errorConditionFormula>ISNEW() &amp;&amp;
ISBLANK(SBQQ__Account__r.NumberOfEmployees)</errorConditionFormula>
        <errorMessage>QT002: Para poder crear la Quote debes primero completar el número de empleados en la Cuenta.</errorMessage>
    </validationRules>
    <validationRules>
        <fullName>QT003_ImpideAvanceSinAprobacion</fullName>
        <active>true</active>
        <errorConditionFormula>IF(AND(
				Quote_Aprobado__c = false,
				ISCHANGED(SBQQ__Status__c),
				OR(
								ISPICKVAL(SBQQ__Status__c, &quot;Sales_Aproved&quot;),	
								ISPICKVAL(SBQQ__Status__c, &quot;Presented_Sent_to_client&quot;),	
								ISPICKVAL(SBQQ__Status__c, &quot;Rejected&quot;)
								),
				OR(
								Requiere_Aprobacion_Comercial__c = true,
								Requiere_Aprobacion_Comision__c = true,
								Requiere_Aprobacion_Dias_Credito__c = true,
								Requiere_Aprobacion_Manager_Comercial__c = true,
								Requiere_Aprobaci_n_Finanzas__c = true
								)
				),
			TRUE, FALSE)</errorConditionFormula>
        <errorMessage>QT003: No puedes avanzar a las etapas resolutorias del proceso sin antes contar con las aprobaciones correspondientes.</errorMessage>
    </validationRules>
</CustomObject>
